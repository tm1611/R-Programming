---
title: "Intermediate R"
author: "Timo Meiendresch"
knit: (function(input_file, encoding) {
  out_dir <- 'html_files';
  rmarkdown::render(input_file,
  encoding=encoding,
  output_file=file.path(dirname(input_file), out_dir, 'Intermediate_R.html'))})
  
---
# Conditionals and Control Flow


## Relational Operators

- Relation of R objects
- Equality (==), Inequality (!=), greater than (>), ...
- In strings: Alphabetical order!
- Note that boolean TRUE coerces to 1 and FALSE to 0

## Logical Operators
Combine several queries (e.g. using several relational operators at once)

- AND operator &
- OR Operator | 
- NOT operator !

```{r}
x <- 12
x > 5 & x < 14
x < 15 | x == 1
```

## Conditional Statements

- if condition 

```r
if (condition) {
  expression
}
```
- if-else condition

```{r}
x <- -3
if(x < 0){
  print("x is a negative number")
} else {
  print("x is not a negative number")
}
```

- else if statement 

```r
if(condition1){
  expr1
} else if(conditon2) {
  expr2
} else {
  expr3
}
```
Extending the example:
```{r}
x <- 0
if(x < 0){
  print("x is a negative number")
} else if(x == 0) {
  print("x is zero")
} else {
  print("x is not a negative number")
}
```

# Loops

### while loop

```r
while(condition){
  expr
}
```

```{r}
ctr <- 1
while(ctr <= 7){
  print(paste("ctr:", ctr))
  ctr <- ctr + 1
}
ctr
```

- break statement

```{r}
ctr <- 1
while (ctr <= 7){
  if(ctr %% 5 == 0){
    break
  }
  print(paste("ctr:", ctr))
  ctr <- ctr +1
}

```

### for loop

```r
for(var in seq){
  expr
}
```
- break: breaks the loop
- next: skips whenever condition is met

```{r}
# for loop, break statement
cities <- list("New York", "Paris","Aachen", "Cologne")
for (city in cities){
  if(nchar(city) == 6){
    break
  }
  print(city)
}

# for loop, next statement
for (city in cities){
  if(nchar(city) == 6){
    next
  }
  print(city)
}
```

- Alternative looping

```{r}
for (i in 1:length(cities)){
  print(paste("City:", i))
  print(cities[i])
}
```

# Functions

- functions work like black box
- argument matching by position or name

```{r}
# help on arguments
args(sd)

# help on function 
#?sd

# linkedin and facebook vectors
linkedin <- c(16, 9, 13, 5, 2, 17, 14)
facebook <- c(17, 7, 5, 16, 8, 13, 14)

# Calculate the mean of the sum
avg_sum <- mean(linkedin + facebook)

# Calculate the trimmed mean of the sum
avg_sum_trimmed <- mean(linkedin + facebook, trim = 0.2)

# Inspect both new variables
avg_sum; avg_sum_trimmed
```

### Writing functions

```r
my_fun <- function(arg1, arg2){
  body
}
```

```{r}
# triple function
triple <- function(x){
  return(3*x)
}
triple(6)

# math_magic()
math_magic <- function(a, b=1){
  a*b + a/b
}
math_magic(4)

```

```{r}
# linkedin and facebook
linkedin <- c(16, 9, 13, 5, 2, 17, 14)
facebook <- c(17, 7, 5, 16, 8, 13, 14)

# The interpret() can be used inside interpret_all()
interpret <- function(num_views) {
  if (num_views > 15) {
    print("You're popular!")
    return(num_views)
  } else {
    print("Try to be more visible!")
    return(0)
  }
}

# Define the interpret_all() function
interpret_all <- function(views, return_sum=TRUE) {
  count <- 0
  for (v in views) {
  count <- count + interpret(v)
  }
  if (return_sum==TRUE) {
  return(count)
  } else {
  return(NULL)
  }
}

# Call the interpret_all() function
interpret_all(linkedin)
interpret_all(facebook)
```

### Packages

```{r}
# Load the ggplot2 package
library(ggplot2)

# try the qplot() function
qplot(mtcars$wt, mtcars$hp)

# Check out the currently attached packages again
search()
```

# The Apply Family


